<html>
<body>
<script type="text/javascript">
<!--
var count = 0;
function addRow(divName){
          var newdiv = document.createElement('div');
          newdiv.innerHTML = "<br />";
          newdiv.innerHTML += "<input type='text' id='name"+count+"'>";
          newdiv.innerHTML += "<input type='text' id='brand"+count+"'>";
          newdiv.innerHTML += "<input type='text' id='price"+count+"'>";
          newdiv.innerHTML += "<input type='text' id='number"+count+"'>";
          newdiv.innerHTML += "<input type='text' id='category"+count+"'>";
          newdiv.innerHTML += "<input type='text' id='att1-"+count+"'>";
          newdiv.innerHTML += "<input type='text' id='att2-"+count+"'>";
          document.getElementById(divName).appendChild(newdiv);
          count++;
}

function product(name, price, number, atts){
	/*string name       : Prin T
	float price         : 19.00
	string number       : 45EW3
	array<string> atts  :  ["blue", "white"], ["s", "m", "l", "xl"]
	*/
	
	this.name = name;
	this.price = price;
	this.number = number;
	this.atts = atts;
}
var products = new Array();

for(i=0; i<10; i++){
	products[i] = new product("Name"+i, 100.95+i, "45EW"+i, ["medium", "large"]);
}

for(p in products){
	//document.write(products[p].name + " " + products[p].price + " "
	 //+ products[p].number + " " + products[p].atts + "<br />");
}

function genCsvDoc(){
    var csv = "";
    
    csv += 'H,Product SKU,Product Name,Vendor Name,Thumbnail Image Filename,Large Image Filename,<Reserved>,';
    csv += 'Description,Fabric,Origin,Price,Sale Price,Tax Code,Defining Attribute 1,Defining Attribute 2,Defining Attribute 3,';
    csv += 'Product Category Name,Item SKU,Parent SKU,'
    csv += 'Defining Attribute 1,Defining Attribute 2,Visibility Indicator,Status,Availability Date';
    
    for(i = 0; i < count; i++){
		csv += '<br />';
		
		var name = document.getElementById("name"+i).value;
        var brand = document.getElementById("brand"+i).value;
        var price = document.getElementById("price"+i).value;
        var number = document.getElementById("number"+i).value;
        var cat = document.getElementById("category"+i).value;
        var att1 = document.getElementById("att1-"+i).value;
        var att2 = document.getElementById("att2-"+i).value;
    
        csv += 'P,' + number + ',' + name + ',' + brand + ',';
        csv += 'T' + number + '.jpg,'; //Thumbnail Image Filename
        csv += number + '.jpg,';       //Large Image Filename
        csv += 'L' + number + '.jpg,'; //<Reserved>
        csv += ',';                    //TODO: description
        csv += ',';                    //fabric
        csv += ',';                    //origin
        csv += price + ',';            //price
        csv += ',';                    //sale price
        csv += '61000,';               //tax code
        csv += att1 + ',';             //attr 1
        csv += att2 + ',';             //attr 2
        csv += ',';					   //attr 3
        csv += cat;			  		   //category name (last item of row)

        for(j=0; j < 10; j++){
			csv += '<br />';
			
			csv += "C,,,,,,,,,,,,,,,,,";
			csv += number + '-' + att1 /*first letter*/+ att2 /*first letter*/ + ',' /*att3*/+',';
			csv += number + ','; //parent sku
			csv += att1 + ',' + att2 + ',' + /*att3*/ ',';
			csv += 'Y,'; //Visibility Indicator, always true
			csv += 'A'; //Status, always available (last item of row)
		}
    }
    document.getElementById("csvDoc").innerHTML = csv;
}

//-->
</script>

<form method="POST">
    <pre>        Name           Brand               Price             Product Number       Category         Attribute 1         Attribute 2</pre>
		 <div id="dynamicInput">
		 </div>
     <input type="button" value="Add another product" onClick="addRow('dynamicInput');">
     <br /><output onforminput="genCsvDoc()"></output>
</form>
<p id="csvDoc"></p>

</body>
</html>
